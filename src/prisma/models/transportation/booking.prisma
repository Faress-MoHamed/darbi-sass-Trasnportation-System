model Booking {
  id                String                    @id @default(uuid()) @db.Uuid
  tenantId          String                    @map("tenant_id") @db.Uuid
  tripId            String?                   @map("trip_id") @db.Uuid
  userId            String?                   @map("user_id") @db.Uuid
  seatNumber        String?                   @map("seat_number") @db.VarChar(10)
  status            BookingStatus
  ticketNumber      String?                   @map("ticket_number") @db.VarChar(100)
  bookingDate       DateTime?                 @map("booking_date")
  paymentId         String?                   @map("payment_id") @db.Uuid

  tenant            Tenant                    @relation(fields: [tenantId], references: [id])
  trip              Trip?                     @relation(fields: [tripId], references: [id])
  user              User?                     @relation(fields: [userId], references: [id])
  payment           Payment?                  @relation(fields: [paymentId], references: [id])

  tickets           Ticket[]
  customFieldValues BookingCustomFieldValue[]

  @@map("bookings")
}

model Subscription {
  id        String              @id @default(uuid()) @db.Uuid
  tenantId  String              @map("tenant_id") @db.Uuid
  userId    String?             @map("user_id") @db.Uuid
  planName  String?             @map("plan_name") @db.VarChar(100)
  startDate DateTime?           @map("start_date") @db.Date
  endDate   DateTime?           @map("end_date") @db.Date
  status    SubscriptionStatus
  price     Decimal?            @db.Decimal(10, 2)

  tenant    Tenant              @relation(fields: [tenantId], references: [id])
  user      User?               @relation(fields: [userId], references: [id])

  @@map("subscriptions")
}

model Ticket {
  id        String    @id @default(uuid()) @db.Uuid
  tenantId  String    @map("tenant_id") @db.Uuid
  bookingId String?   @map("booking_id") @db.Uuid
  qrCode    String?   @map("qr_code") @db.Text
  issuedAt  DateTime? @map("issued_at")

  tenant    Tenant    @relation(fields: [tenantId], references: [id])
  booking   Booking?  @relation(fields: [bookingId], references: [id])

  @@map("tickets")
}

model LoyaltyPoint {
  id        BigInt   @id @default(autoincrement())
  tenantId  String   @map("tenant_id") @db.Uuid
  userId    String?  @map("user_id") @db.Uuid
  points    Int?
  reason    String?  @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at")

  tenant    Tenant   @relation(fields: [tenantId], references: [id])
  user      User?    @relation(fields: [userId], references: [id])

  @@map("loyalty_points")
}

model BookingCustomField {
  id         Int                          @id @default(autoincrement())
  tenantId   String                       @map("tenant_id") @db.Uuid
  name       String                       @db.VarChar(100)
  label      String                       @db.VarChar(150)
  fieldType  FieldType                    @map("field_type")
  required   Boolean?
  options    Json?
  createdAt  DateTime                     @default(now()) @map("created_at")
  updatedAt  DateTime                     @updatedAt @map("updated_at")

  tenant     Tenant                       @relation(fields: [tenantId], references: [id])

  values     BookingCustomFieldValue[]

  @@map("booking_custom_fields")
}

model BookingCustomFieldValue {
  id            BigInt                @id @default(autoincrement())
  bookingId     String                @map("booking_id") @db.Uuid
  customFieldId Int                   @map("custom_field_id")
  value         String?               @db.Text
  updatedAt     DateTime              @updatedAt @map("updated_at")

  booking       Booking               @relation(fields: [bookingId], references: [id])
  customField   BookingCustomField    @relation(fields: [customFieldId], references: [id])

  @@map("booking_custom_field_values")
}