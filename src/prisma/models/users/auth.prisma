// ============================================================================
// Access Tokens & Authentication
// ============================================================================

model AccessToken {
  id               String    @id @default(uuid())
  token            String    @unique
  refreshToken     String    @unique @map("refresh_token")
  userId           String    @map("user_id") @db.Uuid
  tenantId         String    @map("tenant_id") @db.Uuid
  user             User      @relation(fields: [userId], references: [id])
  tenant           Tenant    @relation("tenant_to_accessToken", fields: [tenantId], references: [id])
  createdAt        DateTime  @default(now()) @map("created_at")
  expiresAt        DateTime? @map("expires_at")
  refreshExpiresAt DateTime? @map("refresh_expires_at")

  @@map("access_tokens")
}

model OtpToken {
  id        String    @id @default(uuid()) @db.Uuid
  userId    String    @map("user_id") @db.Uuid
  token     String    @db.VarChar(10)
  expiresAt DateTime  @map("expires_at")
  verified  Boolean   @default(false)
  createdAt DateTime  @default(now()) @map("created_at")
  usedAt    DateTime? @map("used_at")

  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
  @@map("otp_tokens")
}